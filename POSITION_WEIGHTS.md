# Система весов позиций для оптимизации составов команд

## Обзор

Система весов позиций учитывает, что разные позиции имеют различное влияние на общую силу и баланс команд. Сеттер, например, имеет значительно большее влияние на игру команды, чем либеро.

## Веса позиций

```javascript
POSITION_WEIGHTS = {
    'S': 1.3,    // Сеттер - наибольшее влияние
    'OPP': 1.2,  // Диагональный - высокое влияние
    'OH': 1.1,   // Доигровщик - среднее влияние
    'MB': 1.0,   // Центральный блокирующий - базовое влияние
    'L': 0.9     // Либеро - наименьшее влияние
}
```

## Обоснование весов

### Сеттер (S, вес: 1.3) - "Мозг команды"
- Определяет всю атакующую комбинацию
- Влияет на эффективность всех нападающих
- Критически важен для игры команды
- Разница в качестве сеттера имеет наибольшее влияние на результат

### Диагональный (OPP, вес: 1.2) - "Основная мощь атаки"
- Часто самый результативный игрок
- Атакует с задней линии
- Высокая ответственность в ключевые моменты
- Основная ударная сила команды

### Доигровщик (OH, вес: 1.1) - "Универсальный солдат"
- Играет в приеме и атаке
- Важен для стабильности игры
- Универсальность делает его очень ценным

### Центральный блокирующий (MB, вес: 1.0) - "Базовая единица"
- Базовая важность, эталон для сравнения
- Важен в блоке и быстрых атаках
- Используется как reference point для других позиций

### Либеро (L, вес: 0.9) - "Специалист защиты"
- Не участвует в атаке у сетки
- Фокус на приеме и защите
- Ограниченное влияние на общую силу команды в контексте балансировки

## Примеры расчетов

### Пример 1: Базовый расчет силы команды

**Команда без весов:**
```
Сеттер: 1800 ELO
Либеро: 1700 ELO
Общая сила = 1800 + 1700 = 3500
```

**Команда с весами:**
```
Сеттер: 1800 × 1.3 = 2340
Либеро: 1700 × 0.9 = 1530
Взвешенная сила = 2340 + 1530 = 3870
```

### Пример 2: Сравнение двух команд

#### Без учета весов:
```
Команда 1: Сеттер (1800) + Либеро (1700) = 3500
Команда 2: Сеттер (1700) + Либеро (1800) = 3500
Разница: 0 (команды выглядят одинаковыми)
```

#### С учетом весов:
```
Команда 1: Сеттер (1800 × 1.3) + Либеро (1700 × 0.9) = 2340 + 1530 = 3870
Команда 2: Сеттер (1700 × 1.3) + Либеро (1800 × 0.9) = 2210 + 1620 = 3830
Разница: 40 очков (Команда 1 сильнее из-за лучшего сеттера)
```

**Вывод:** Система весов правильно определяет, что команда с более сильным сеттером имеет преимущество, даже если у нее более слабый либеро.

### Пример 3: Полный состав команды

```
Сеттер (S):     1900 × 1.3 = 2470
Диагональный (OPP): 1850 × 1.2 = 2220
Доигровщик (OH):    1800 × 1.1 = 1980
Доигровщик (OH):    1750 × 1.1 = 1925
Центральный (MB):   1700 × 1.0 = 1700
Либеро (L):     1650 × 0.9 = 1485

Общая сила (raw):      10650
Взвешенная сила:       11780
```

## Влияние на оптимизацию

Система весов влияет на три ключевых аспекта оптимизации:

1. **Вычисление силы команды** (`calculateTeamStrength`)
   - Использует взвешенные рейтинги для более точной оценки

2. **Оценка баланса** (`evaluateSolution`)
   - Минимизирует разницу во взвешенной силе команд
   - Учитывает позиционный дисбаланс с весами

3. **Адаптивные обмены** (`performAdaptiveSwap`)
   - Определяет сильнейшую/слабейшую команду по взвешенному рейтингу
   - Обмены игроков учитывают их позиционный вес

## Настройка весов

Веса можно настроить в файле `src/services/EloService.js`:

```javascript
this.POSITION_WEIGHTS = {
    'S': 1.3,    // Можно изменить на 1.2-1.4
    'OPP': 1.2,  // Можно изменить на 1.1-1.3
    'OH': 1.1,   // Можно изменить на 1.0-1.2
    'MB': 1.0,   // Рекомендуется оставить как базу
    'L': 0.9     // Можно изменить на 0.8-1.0
};
```

**Рекомендации по настройке:**
- MB всегда должен быть 1.0 (базовая единица)
- S должен иметь наибольший вес
- Разница между соседними позициями: 0.1-0.2
- Диапазон всех весов: 0.8-1.4

## Отображение в UI

В интерфейсе команд показываются оба рейтинга:

```
Team 1
12850 weighted ELO (11500 raw, avg 1917)
```

Где:
- **weighted ELO** - взвешенный рейтинг с учетом позиций
- **raw** - сумма рейтингов без весов
- **avg** - средний рейтинг игроков
